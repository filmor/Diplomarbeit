\section{Asymptotics of the Boundary Parametrix}
By using a summation formula that is derived in \cite[2.2]{LV13}, the existence
and values of the asymptotic components of $\Tr(\Delta_\lambda + z^2)^{-1}$ at
the boundary can be calculated directly. By \cref{frm:shift} we know, that we
only have to consider terms up to order $O(\Abs{(\lambda,z)}^{-3})$ since the
requested asymptotic coefficient is of order $-3$ in the resolvent.  The method
derived in this section can however be used to also extract higher orders.

\subsection{Preliminaries}
We will first briefly step through the process that justifies the formula for
the trace-resolvent we are going to use, based on \cite{LV13}.  Without loss of
generality we will use $x = 0$ as the model case here, by the substitution
$x\mapsto 1-x$ we get very similar results for $x=1$ which will be formulated as
a Corollary. The parametrix of $\Delta_\lambda + z^2$ near the boundary $x=0$
can be constructed explicitly. We first consider $L := \Delta_\lambda -
f_\lambda(x) = -\partial_x^2$ acting on $C_0^\infty(\mathbb{R})$, which is
essentially self-adjoint in $L^2(\mathbb{R})$, we denote the self-adjoint
extension by $\overline L$. Now, for $\theta \in [0,\pi)$, let $L^\theta$ be
  $\overline L$ restricted to
\begin{equation*}
  \mathcal{D}(L^\theta) := \left\{ f\in H^1\Rplus\, \middle|\, f(0)\cos\theta +
  f'(0)\sin(\theta) = 0\right\},
\end{equation*}
i.e.\ we employ generalised Neumann boundary conditions. The case $\theta =
\pi$, which is $f'(0) = 0$, is taken out of this although it behaves essentially
the same, we will note it where this matters.

For $\mu\in\mathbb{C}$, $\Re\mu > 0$ one can show, that the resolvent kernel of
$(\overline L + \mu^2)^{-1}$ is given by
\begin{equation*}
  k_{(\overline L + \mu^2)^{-1}}(x,y;\mu) = \frac1{2\mu}\Eto{-\mu\Abs{x-y}},
\end{equation*}
and the kernel of $(L^\theta+\mu^2)^{-1}$ by
\begin{align}
  \label{frm:k-l-theta}
  k_{(L^\theta +\mu^2)^{-1}}(x,y;\mu) = \frac1{2\mu} \left( \Eto{-\mu\Abs{x-y}} +
  C(\mu,\theta)\Eto{-\mu(x+y)}\right), \\
  \label{frm:c-mu-theta}
  \text{with} \quad C(\mu,\theta) :=
  \frac{\mu\sin\theta+\cos\theta}{\mu\sin\theta-\cos\theta}.
\end{align}
However we are interested in the kernel of $(\Delta_\lambda + z^2)^{-1}$ for the
chosen boundary conditions near $x = 0$, namely $(L^\theta + f_\lambda(x) +
z^2)^{-1}$. Let
\begin{equation}
  \label{def:mu}
  \mu^2 := \lambda^2 V(0) + z^2
\end{equation}
and note that $\mu^2 = (\mu(0))^2$ using the definition from
\cref{main:interior}. We will use this abbreviation in this section also as a
substitute for $\Abs{(\lambda,z)}$. Since $V\in C_0^\infty([0,1])$ and $V > 0$
we have $V(0) > 0$ (and $V(1) > 0$), this gives of course the same analytical
results, in particular asymptotics for $\mu\to\infty$ is the same as asymptotics
for $\Abs{(\lambda,z)}\to\infty$.

Now we aim to rewrite the operator-inverse such that we are only inverting
operators that don't depend explicitly on the functions $V$ and $W$, in
particular we will rewrite it in terms of $(L+\mu^2)$ and $(L^\theta+\mu^2)$ for
which we have explicit expressions of their inverses' kernels. We assume for now
for some $\delta > 0$ sufficiently small that $\supp V \subset [0,\delta]$ and
$\InfNorm{V-V(0)}\leq \frac12V(0)$. We define $\tilde V(x) := V(x) - V(0)$.
Algebraically we have
\begin{equation*}
  (L^\theta + \lambda^2 V(x) + W(x) + z^2)^{-1} =
    \bigl(I + (L^\theta + \mu^2)^{-1}(\lambda^2\tilde V(x) + W(x))\bigr)^{-1}
    (L^\theta + \mu^2)^{-1}.
\end{equation*}
Since for $z$ sufficiently large we have (with $\OpNorm{\,\cdot\,}$ being the
operator norm)
\begin{align*}
  \OpNorm{(L^\theta + \mu^2)^{-1}(\lambda^2\tilde V(x) + W(x))} \leq
  \frac{\lambda^2\InfNorm{\tilde V} + \InfNorm{W}}{\lambda^2 V(0) + z^2},
  \text{ as } \InfNorm{\tilde V} \leq \frac12V(0)
\end{align*}
we can write this as a converging Neumann series:
\begin{multline}
  \label{frm:neumann-sum}
  \Rightarrow (L^\theta + \lambda^2 V(x) + W(x) + z^2)^{-1} \\ =
    \sum_{j=0}^\infty (-1)^j \left((L^\theta + \mu^2)^{-1}(\lambda^2\tilde V(x)
    + W(x))\right)^j (L^\theta + \mu^2)^{-1}.
\end{multline}
Now, back to our original $V$ and $W$, we introduce cutoff functions $\phi,
\psi\in\Cinf(\Rplus)$ that are $1$ in a neighbourhood of $x = 0$ and $0$ on
$[\delta,\infty)$. Furthermore $\supp\phi\subset\supp\psi$ and
$\supp\psi\,\cap\,\supp\mathrm d\psi = \emptyset$. Setting $W_\psi(x) :=
\psi(x)W(x)$ and $\tilde V_\psi(x) = \psi(x)V(x) - V(0)$ we have by choosing
$\delta$ small enough $\InfNorm{\tilde V_\psi} < \frac12V(0)$, as needed for the
Neumann series expansion. Let
\begin{align}
  \label{frm:r-delta}
  R_\delta &:= \psi(L^\theta + \lambda^2V_\psi(x) + W_\psi(x) + z^2)^{-1}\phi \\
  \label{def:f-lambda}
  \text{and } f_\lambda(x) &:= \lambda^2\tilde V_\psi(x) + W_\psi(x).
\end{align}
Note that $f_\lambda(x)$ is notated $\lambda(V,W)(x)$ in \cite{LV13}, we'll use
this notation to make the distinction between $\lambda$ as a parameter and the
function (which is of order $2$ in $\lambda$) clearer.

It is shown in \cite[Sec.~2]{LV13}, that the previous choices do not change the
asymptotic behaviour of the resolvent trace at $x=0$ and that for $R_\delta$ the
right-hand-side in \cref{frm:neumann-sum} is well-defined:
\begin{equation*}
  \Tr((L^\theta + \lambda^2 V(x) + W(x) + z^2)^{-1}\phi) =
  \Tr R_\delta + O(\mu^{-\infty}), \quad \text{as } \mu\to\infty.
\end{equation*}
We define
\begin{equation}
  \label{frm:r-theta}
  R^\theta := (L^\theta + \mu^2)^{-1},
\end{equation}
for which we already know the kernel by \cref{frm:k-l-theta}:
\begin{equation*}
  k_{R^\theta}(x,y;\mu) = \frac1{2\mu} \left( \Eto{-\mu\Abs{x-y}} +
  C(\mu,\theta)\Eto{-\mu(x+y)}\right)
\end{equation*}
We denote by $R_-$ and $R_+$ operators belonging to the kernels
\begin{align*}
  k_{R_-}(x,y;\mu) := \tfrac1{2\mu}\Eto{-\mu\Abs{x-y}} \text{ and }
  k_{R_+}(x,y;\mu) := \tfrac1{2\mu}C(\mu,\theta)\Eto{-\mu(x+y)},
\end{align*}
such that $R^\theta = \tfrac1{2\mu}(R_- + R_+)$. Now we can write our Neumann
series as
\begin{equation*}
  R_\delta = \sum_{j=0}^\infty (-1)^j M_\psi (R^\theta
  M_{f_\lambda})^j R^\theta M_\phi,
\end{equation*}
where we have this one time explicitly written out $M_f$ to emphasise that we
mean the multiplication operator, whose kernel is given by the Dirac
delta-distribution as
\begin{equation*}
  k_{M_f}(x,y) = \delta(x-y)f(x).
\end{equation*}
Now we insert our newly defined operators $R_-$ and $R_+$ into the sum and split
of the terms that only contain $R_-$. To simplify the expressions we define an
abbreviation for the compositions. Let $n\in\mathbb{N}$ and $\sigma \in
\{+,-\}^n$, i.e.\ a tuple of symbols $+$ and $-$, which we will denote when
given explicitly by, e.g.\ $++--+$. Then we recursively (starting with the
already defined $R_-$ and $R_+$) define
\begin{equation}
  R_\sigma := R_{\sigma_1} M_{f_\lambda} R_{(\sigma_2,\ldots,\sigma_{n})},
\end{equation}
for which we can also give the kernels explicitly by use of the general formula
$k_{AB}(x,y) = \Integ{\mathbb{R}}{z}{k_A(x,z)k_B(z,y)}$, where we, by slight
abuse of notation, reuse the variable $z$ in the following to denote the
integration variable.  This won't lead to ambiguity as the resolvent variable
$z$ is hidden in $\mu$ for the whole section. We have
\begin{align}
  \label{eqn:kernel-plus}
  k_{R_{(+,\sigma_1,\ldots,\sigma_n)}}(x,y) &=
  \frac1{2\mu}C(\mu,\theta)\Int{z}{\Eto{-\mu(x+z)}f_\lambda(z)
  k_{R_\sigma}(z,y)} \\
  \label{eqn:kernel-minus}
  k_{R_{(-,\sigma_1,\ldots,\sigma_n)}}(x,y) &=
  \frac1{2\mu}\Int{z}{\Eto{-\mu\Abs{x-y}}f_\lambda(z) k_{R_\sigma}(z,y)},
\end{align}
where we have already executed the trivial integral from composing with the
kernel of the multiplication operator $M_{f_\lambda}$ given by $\delta(x -
y)f_\lambda(x)$.

We can now express, by use of $R_\theta = R_- + R_+$, $R_\delta$ in the
following way:
\begin{align}
  R_\delta = \sum_{j=0}^\infty (-1)^j \psi(x)
  \ \sum_{\mathclap{\sigma\in\{+,-\}^{j+1}}} R_\sigma \phi(x)
\end{align}
The two last results we have to cite are the fact, that terms with $\sigma =
(-,\ldots,-)$ don't contribute to the asymptotics, thus we can rewrite the
formula as
\begin{equation}
  R^{(j)} = (-1)^j \sum_{\mathclap{\substack{ \sigma\in\{+,-\}^{j+1} \\
  \sigma\neq(-,\ldots,-) }}} \psi R_\sigma \phi
  \quad \Rightarrow \quad R^0_\delta =
  \sum_{j=0}^\infty R^{(j)},
\end{equation}
and the following theorem (\cite[Prop.~2.2]{LV13}), that will be central to the
further considerations:
\begin{Theorem}
  \label{thm:r-expansion}
  Let $M\in\mathbb{N}$, $\alpha,\beta\in\mathbb{N}_0$ be fixed. For $\mu_0$
  sufficiently large there exist constants $C>0$, $q\in(0,1)$ such that for
  $N\geq M$ and $\mu \geq \mu_0$
  \begin{equation*}
    \Norm[\mathrm{tr}]{\partial_\lambda^\alpha\partial^\beta_z R^{(N)}}
    \leq CNq^{N-M}\mu^{-M-\alpha-\beta-3/2}
  \end{equation*}
  and thus for $\mu\to\infty$
  \begin{equation*}
    \Norm[\mathrm{tr}]{\partial^\alpha_\lambda\partial^\beta_z\sum_{j=M}^\infty
    R^{(j)}} = O(\mu^{-M-\alpha-\beta-3/2}),
  \end{equation*}
  where $\|\cdot\|_{\mathrm{tr}}$ denotes the trace norm
  ($\|A\|_\mathrm{tr} = \Tr\bigl((A^*A)^{1/2}\bigr) = \Tr\Abs{A}$).
\end{Theorem}
This tells us that since we are aiming to find the asymptotics up to order $2$
we need to consider $R^{(j)}$ up to $j=1$, since already the trace of $R^{(2)}$
is $O(\mu^{-7/2})$, i.e.\ $o(\mu^{-3})$.

\subsection{Calculations}
Equipped with the definitions and theorems of the preceding subsection we can
explicitly calculate the asymptotics of the resolvent trace, which we will do
now for $x=0$. The case $x=1$ is identical to this one if we employ the
transformation $x\mapsto 1-x$, which results in a sign change for odd
derivatives of $f_\lambda(x)$, and of course evaluation at $x=1$ instead of $0$.
From the above considerations we know that we will have to calculate the
asymptotics of $3$ traces.

In the following calculations we define analogous to $R_\sigma$ the factor
\begin{equation}
  C_{(\sigma_1,\ldots,\sigma_n)} := (-1)^{n+1}\Bigl(\frac{1}{2\mu}\Bigr)^n
  \prod_{ \substack{ 1\le i \le n \\ \sigma_i = - }} C(\mu,\theta).
\end{equation}
For $c$ being the count of minuses in $\sigma$ we can see that
$\lim_{\mu\to\infty} C_\sigma = (-1)^{n+c+1} (2\mu)^{-n}$, since $C(\mu,\theta)
\to -1$. For $\theta = \pi$ we'd get a different result here, namely $C_\sigma
\to (-1)^{n+1}(2\mu)^{-n}$ since $C(\mu,\pi)\to +1$.

The calculation of all terms with $\sigma=(+,\ldots,+)\in\{-,+\}^j$ is
straightforward:
\begin{equation}
  \label{frm:r-plusplus}
  \begin{split}
    \Tr R_{+\ldots+} &=
    C_{+\ldots+}
    \Int{x}{\left(
      \Integ{[0,1]^{j-1}}{z}{
        \Eto{-\mu((x + z_1) + (z_1 + z_2) + \ldots + (z_{j-1} + x))}
        \prod_{i=1}^{j-1} f_\lambda(z_i)
      }\right)
    } \\
    &= C_{+\ldots+}
    \Int{x}{\Eto{-2\mu x}} \left(\Int{z}{\Eto{-2\mu
    z}f_\lambda(z)}\right)^{j-1} \\
    &= C_{+\ldots+}
    \left(\frac1{2\mu} - \frac{\Eto{-2\mu}}{2\mu}\right)
    \left(\Int{z}{\Eto{-2\mu z}f_\lambda(z)}\right)^{j-1} \\
    &\SimMu (-2\mu)^{-j-1}
    \left(\Wsum{f_\lambda^{(n)}}\right)^{j-1} = (-1)^{j-1} (2\mu)^{-2j}
    \left(\sum_{n=0}^\infty\frac{f_\lambda^{(n)}(0)}{(2\mu)^n}\right)^{j-1}.
  \end{split}
\end{equation}
The last transformation uses Watson's lemma as well as the fact that we can
apply it simultaneously to multiple integrals to determine the common
asymptotics, which is ensured by the finiteness of $F(x) =
\Int{x}{\Eto{-tx}f(t)}$ using \cref{lem:continuity_of_watson_integrals}.

From this calculation we immediately get the first term we were looking for:
\begin{equation}
  \label{eqn:tr1}
  \Tr R^{(1)} = \Tr R_+ \SimAs{\mu\to\infty} (2\mu)^{-2}
\end{equation}

For higher $j$ terms we need to employ both Watson's lemma and our triangle
integration formula (\cref{lem:triangle-integration}). Using them we derive a
finite product of infinite sums as the asymptotic expansion. To get an actual
coefficient from that we use combinatorics (we could of course just combine the
sum using the Cauchy product formula, but that will just result in a much more
complicated term).

From \cref{frm:r-plusplus} we know, that 
\begin{equation*}
  \Tr R_{++} = -(2\mu)^{-4}\sum_{n=0}^\infty \frac{f^{(n)}_\lambda(0)}{(2\mu)^n},
\end{equation*}
leading to two contributions. Now we only need to calculate $\Tr R_{+-}$ for
$j=1$, since $\Tr R_{+-} = \Tr R_{-+}$. We define $\Integ[x]{0}{f_\lambda(x)} :=
F_\lambda(x)$.
\begin{align*}
  \Tr R_{+-} &= C_{+-} \Int{x}{
      \Int{z}{
        \Eto{-\mu(x+z+\Abs{z-x})}
        f_\lambda(z)
      }
    }, \\
    \intertext{now we split the integral at $x$,}
    &= C_{+-} \Int{x}{
      \left(
        \Integ[x]{0}{z}{
          \Eto{-\mu(x+z+x-z)} f_\lambda(z)
        }
      + \Integ[1]{x}{z}{
          \Eto{-\mu(x+z-x+z)} f_\lambda(z)
        }
      \right)
    } \\
    &= C_{+-} \left(\Int{x}{\Integ[x]{0}{z}{\Eto{-2\mu x} f_\lambda(z)}}
    + \Int{x}{\Integ[1]{x}{z}{\Eto{-2\mu z}f_\lambda(z)}} \right),
    \intertext{use our triangle integration formula
      from \cref{lem:triangle-integration} with $f\equiv f_\lambda$, $g\equiv 1$
    in the second summand, the definition of $F_\lambda$ in the first summand,}
    &= C_{+-} \left(
      \Int{x}{\Eto{-2\mu x} F_\lambda(x)}
      + \Int{x}{\Eto{-2\mu x} xf_\lambda(x)}
      \right),
      % Result:
      \intertext{and finally use Watson's lemma on the exponential integrals}
    &\SimAs{\mu\to\infty} %
      (2\mu)^{-2}\left(
      \Wsum{F_\lambda^{(n)}} + \Wsum{nf_\lambda^{(n-1)}}\right)
      = (2\mu)^{-3} \sum_{n=1}^\infty\frac{(n+1)f_\lambda^{(n-1)}(0)}{(2\mu)^n},
\end{align*}
since $F_\lambda(0) = 0$. We have also used the identity $(xf(x))^{(n)} =
xf^{(n)}(x) + nf^{(n-1)}(x)$ (which results in the $nf_\lambda^{(n-1)}(0)$ term
as we evaluate at $0$) as well as the triangle integration. Since the integral
is symmetrical this also gives $\Tr R_{-+}$, so we have:
\begin{equation}
  \label{eqn:tr2}
  \begin{split}
    \Tr R^{(2)} &\SimAs{\mu\to\infty} (2\mu)^{-4} \sum_{n=0}^\infty
  \frac{2(n+2)f_\lambda^{(n)}(0) - f^{(n)}_\lambda(0)}{(2\mu)^n} \\ &=
    (2\mu)^{-4} \sum_{n=0}^\infty \frac{(2n + 3)f_\lambda^{(n)}(0)}{(2\mu)^n}
  \end{split}
\end{equation}
Now that we have calculated $\Tr R^{(1)}$ and $\Tr R^{(2)}$ we only need to sum
them up and match coefficients to get the first terms in the asymptotic
expansion of $\Tr(\Delta_\lambda + z^2)^{-1}$. In particular we have to deal
with the fact that $f_\lambda(x) = \lambda^2 V_\psi(x) + W_\psi(x)$ is of mixed
order.  Furthermore we note that, as it was for the interior parametrix, the
coefficients of the trace expansion are again a homogeneous polynomial in $V$,
$W$ and their respective derivatives, which will be proven in the next section.
In contrast to the interior parametrix the even integral orders do not vanish by
construction. Also the starting order is $-2$ instead of $-1$.

We get the following terms of the asymptotic expansion of $\Tr R^0_\delta$:
\begin{align}
  (\Tr R)_{-2} &= \frac{1}{4\mu^2} = \frac{1}{4} (\lambda^2V(0) + z^2)^{-1} \\
  (\Tr R)_{-3} &= \frac{5\lambda^2}{(2\mu)^5} V'(0) =
  \frac{5}{32}\frac{\lambda^2 V'(0)}{(\lambda^2 V(0) + z^2)^{5/2}}
\end{align}

We have thus proven the following theorem
\begin{MainTheorem}
  \label{main:boundary}
  \input{snippets/main-exterior}
  \begin{Corollary}
    \label{cor:boundary}
    Using the previous definitions we also get the expansion near $1$ by
    considering a new cutoff function $\psi$ on $(0,1]$ that is $0$ outside of a
    sufficiently small neighbourhood of $x=1$:
    \begin{equation*}
      \Tr\left(\psi(x)(\Delta_\lambda + z^2)^{-1}\right) \SimMu
      \frac{1}{(2\mu)^2} - \frac{5\lambda^2}{(2\mu)^5} V'(1) + O(\mu^{-4}),
    \end{equation*}
    with $\mu^2 := \lambda^2 V(1) + W(1)$.
    \begin{Proof}
      Apply \thref{main:boundary} to the operator
      \begin{equation*}
        \tilde\Delta_\lambda = \Delta_\lambda\circ(x\mapsto 1-x).
      \end{equation*}
      That way all analytical properties are kept, but $\partial_x^n|_{x=0}
      \mapsto (-1)^n \partial_x^n|_{x=1}$, so a sign is introduced for odd
      derivatives and we evaluate at $x=1$.
    \end{Proof}
  \end{Corollary}
\end{MainTheorem}
